Author: Pino Toscano <pino@debian.org>
Description: Bump the library version ABI
 libindi's API is not final until 1.0 but upstream does not bump SONAME,
 so manually bump the SONAME and library VERSION ourselves.
Origin: vendor
Last-Update: 2012-03-23
Forwarded: not-needed

Index: libindi/CMakeLists.txt
===================================================================
--- libindi.orig/CMakeLists.txt	2014-04-01 15:42:57.788088964 +0200
+++ libindi/CMakeLists.txt	2014-04-01 15:52:19.949524550 +0200
@@ -5,10 +5,16 @@
 
 ##################  INDI version  ################################
 set(INDI_SOVERSION "0")
+set(CLIENT_INDI_SOVERSION "0b")
+set(DRIVER_INDI_SOVERSION "0b")
 set(CMAKE_INDI_VERSION_MAJOR 0)
 set(CMAKE_INDI_VERSION_MINOR 9)
 set(CMAKE_INDI_VERSION_RELEASE 8)
 set(CMAKE_INDI_VERSION_STRING "${CMAKE_INDI_VERSION_MAJOR}.${CMAKE_INDI_VERSION_MINOR}.${CMAKE_INDI_VERSION_RELEASE}")
+set(CMAKE_INDI_CLIENT_VERSION_STRING
+    "${CLIENT_INDI_SOVERSION}.${CMAKE_INDI_VERSION_MINOR}.${CMAKE_INDI_VERSION_RELEASE}")
+set(CMAKE_INDI_DRIVER_VERSION_STRING
+    "${DRIVER_INDI_SOVERSION}.${CMAKE_INDI_VERSION_MINOR}.${CMAKE_INDI_VERSION_RELEASE}")
 
 ##################  Paths  ################################
 set(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake_modules/")
@@ -147,7 +153,8 @@
 target_link_libraries(indi ${NOVA_LIBRARIES} ${M_LIB} ${ZLIB_LIBRARY} ${CFITSIO_LIBRARIES})
 
 install(TARGETS indi LIBRARY DESTINATION ${LIB_DESTINATION})
-set_target_properties(indi PROPERTIES VERSION ${CMAKE_INDI_VERSION_STRING} SOVERSION ${INDI_SOVERSION})
+set_target_properties(indi PROPERTIES VERSION ${CMAKE_INDI_CLIENT_VERSION_STRING}
+    SOVERSION ${CLIENT_INDI_SOVERSION})
 
 ###################################################
 ############ INDI Main Shared Library #############
@@ -175,7 +182,9 @@
 add_library(indidriverstatic STATIC ${libindicom_SRCS} ${liblilxml_SRCS} ${indimain_SRCS} ${indidriver_SRCS})
 target_link_libraries(indidriverstatic ${LIBUSB_1_LIBRARIES} ${NOVA_LIBRARIES} ${CMAKE_THREAD_LIBS_INIT} ${CFITSIO_LIBRARIES} ${M_LIB} ${ZLIB_LIBRARY})
 endif (${CMAKE_SYSTEM_NAME} MATCHES "Linux")
-set_target_properties(indidriver indidriverstatic PROPERTIES VERSION ${CMAKE_INDI_VERSION_STRING} SOVERSION ${INDI_SOVERSION} OUTPUT_NAME indidriver)
+set_target_properties(indidriver indidriverstatic PROPERTIES
+    VERSION ${CMAKE_INDI_DRIVER_VERSION_STRING}
+    SOVERSION ${DRIVER_INDI_SOVERSION} OUTPUT_NAME indidriver)
 install(TARGETS indidriver LIBRARY DESTINATION ${LIB_DESTINATION})
 install(TARGETS indidriverstatic ARCHIVE DESTINATION ${LIB_DESTINATION})
 
